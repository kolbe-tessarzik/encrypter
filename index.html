<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Encrypter</title>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  :root {
    --bg: #0f172a;
    --surface: #1e293b;
    --border: #334155;
    --text: #f1f5f9;
    --text-dim: #94a3b8;
    --accent: #3b82f6;
    --accent-hover: #2563eb;
    --success: #10b981;
  }

  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    padding: 2rem;
  }

  .container {
    max-width: 1200px;
    width: 100%;
    margin: 0 auto;
  }

  header {
    margin-bottom: 3rem;
    text-align: center;
  }

  h1 {
    font-size: 2.5rem;
    font-weight: 700;
    background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 0.5rem;
  }

  .subtitle {
    color: var(--text-dim);
    font-size: 1rem;
  }

  .key-section {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 2rem;
  }

  .key-label {
    display: block;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-dim);
    margin-bottom: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  input[type="text"] {
    width: 100%;
    padding: 0.875rem 1rem;
    font-size: 1rem;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--text);
    transition: all 0.2s ease;
  }

  input[type="text"]:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }

  .editor-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .editor-panel {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .editor-header {
    padding: 1rem 1.25rem;
    background: rgba(59, 130, 246, 0.05);
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .editor-title {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .editor-count {
    font-size: 0.75rem;
    color: var(--text-dim);
    font-variant-numeric: tabular-nums;
  }

  textarea {
    width: 100%;
    height: 400px;
    padding: 1.25rem;
    font-size: 0.95rem;
    font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
    background: var(--bg);
    border: none;
    color: var(--text);
    resize: vertical;
    line-height: 1.6;
  }

  textarea:focus {
    outline: none;
  }

  textarea::placeholder {
    color: var(--text-dim);
    opacity: 0.5;
  }

  #encrypted {
    color: var(--success);
    background: rgba(16, 185, 129, 0.03);
  }

  .stats-bar {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 1.25rem 1.5rem;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 2rem;
  }

  .stat {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
  }

  .stat-label {
    font-size: 0.75rem;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .stat-value {
    font-size: 1.5rem;
    font-weight: 700;
    font-variant-numeric: tabular-nums;
  }

  .stat-value.positive {
    color: var(--success);
  }

  .stat-value.negative {
    color: #ef4444;
  }

  .stat-value.neutral {
    color: var(--text-dim);
  }

  @media (max-width: 768px) {
    body {
      padding: 1rem;
    }

    h1 {
      font-size: 2rem;
    }

    .editor-grid {
      grid-template-columns: 1fr;
    }

    .stats-bar {
      flex-direction: column;
      gap: 1rem;
      display: none;
    }
  }
</style>
</head>
<body>

<div class="container">
  <header>
    <h1>Encrypter</h1>
  </header>

  <div class="key-section">
    <label class="key-label" for="key">Encryption Key (Optional)</label>
    <input type="text" id="key" placeholder="Enter a password to encrypt the mapping...">
  </div>

  <div class="editor-grid">
    <div class="editor-panel">
      <div class="editor-header">
        <span class="editor-title">Original Text</span>
        <span class="editor-count" id="originalCount">0 characters</span>
      </div>
      <textarea id="original" placeholder="Type or paste your text here..."></textarea>
    </div>

    <div class="editor-panel">
      <div class="editor-header">
        <span class="editor-title">Encrypted Output</span>
        <span class="editor-count" id="encryptedCount">0 characters</span>
      </div>
      <textarea id="encrypted" placeholder="Symbols will appear here..."></textarea>
    </div>
  </div>

  <div class="stats-bar">
    <div class="stat">
      <span class="stat-label">Compression</span>
      <span class="stat-value neutral" id="compressionValue">0%</span>
    </div>
    <div class="stat">
      <span class="stat-label">Size Reduction</span>
      <span class="stat-value neutral" id="reductionValue">0 chars</span>
    </div>
  </div>
</div>

<script>
const originalBox = document.getElementById("original");
const encryptedBox = document.getElementById("encrypted");
const keyBox = document.getElementById("key");
const originalCount = document.getElementById("originalCount");
const encryptedCount = document.getElementById("encryptedCount");
const compressionValue = document.getElementById("compressionValue");
const reductionValue = document.getElementById("reductionValue");

// Enhanced Alphabet with more symbols for encoding
const normalAlphabet = 
  "abcdefghijklmnopqrstuvwxyz" +
  "ABCDEFGHIJKLMNOPQRSTUVWXYZ" +
  "0123456789" +
  " .,!?:;'\"-_=+()[]{}<>/@#$%&*\\|^~`\n";

// Enhanced Dictionary with more patterns for better compression
const baseWords = [
  // Original content
  "the", "and", "ing", "ion", "tio", "ent", "ati", "for", "her", "ter", 
  "hat", "tha", "ere", "ate", "his", "con", "res", "ver", "all", "ons",
  "nce", "men", "ith", "ted", "ers", "pro", "thi", "wit", "are", "ess",
  "not", "ive", "was", "ect", "rea", "com", "eve", "per", "int", "est",
  "sta", "cti", "ica", "ist", "ear", "ain", "one", "our", "iti", "rat", "res",
  
  "of the", "in the", "to the", "for the", "on the", "at the", "from the", "with the", "by the", "and the",
  "that the", "is the", "as the", "was the", "are the", "it is", "there is", "there are", "this is",
  "it was", "I am", "you are", "we are", "they are", "he is", "she is", "I have", "you have", "we have",
  "they have", "I will", "you will", "we will", "they will", "do not", "does not", "did not", "is not",
  "are not", "was not", "were not", "have not", "has not", "had not", "will not", "would not", "should not",
  "could not", "cannot", "can not", "I would", "you would", "he would", "she would", "we would", "they would",
  
  "a ", "b ", "c ", "d ", "e ", "f ", "g ", "h ", "i ", "j ", "k ", "l ", "m ",
  "n ", "o ", "p ", "q ", "r ", "s ", "t ", "u ", "v ", "w ", "x ", "y ", "z ",
  "A ", "B ", "C ", "D ", "E ", "F ", "G ", "H ", "I ", "J ", "K ", "L ", "M ",
  "N ", "O ", "P ", "Q ", "R ", "S ", "T ", "U ", "V ", "W ", "X ", "Y ", "Z ",
  
  ". ", ", ", "; ", ": ", "! ", "? ", " - ", " (", ") ", "[ ", "] ", "{ ", "} ", 
  " '", "' ", " \"", "\" ", " `", "` ", " /", "\\ ", " |", " @", " #", " $", " %",
  
  "ed ", "ing ", "ly ", "ment", "able", "tion", "ness", "less", "ful", "ive",
  "al ", "ic ", "ous", "ive", "ent", "ant", "ance", "ence", "ity", "ship",
  
  "un", "re", "dis", "pre", "post", "anti", "sub", "over", "under", "super",
  
  "the ", "and ", "for ", "you", "with", "this", "that", "have", "from", "they",

  // Massive expansion
  // Common words
  "about", "after", "again", "against", "all", "also", "an", "any", "as", "at",
  "be", "because", "been", "before", "being", "both", "but", "by", "can", "come",
  "could", "day", "did", "do", "down", "each", "even", "first", "found", "get",
  "go", "good", "great", "had", "has", "have", "he", "help", "her", "here",
  "him", "his", "how", "I", "if", "in", "into", "is", "it", "its",
  "just", "know", "like", "look", "made", "make", "man", "many", "may", "me",
  "more", "most", "my", "new", "no", "not", "now", "of", "on", "one",
  "only", "or", "other", "our", "out", "over", "own", "people", "said", "see",
  "she", "should", "so", "some", "such", "take", "than", "that", "the", "their",
  "them", "then", "there", "these", "they", "thing", "think", "this", "those", "time",
  "to", "two", "up", "us", "use", "very", "was", "way", "we", "well",
  "were", "what", "when", "where", "which", "who", "will", "with", "word", "work",
  "would", "write", "year", "you", "your",

  // Common word endings/patterns
  "able", "ably", "al", "ally", "ance", "ancy", "ant", "ate", "ation", "ative",
  "cy", "dom", "ed", "ee", "een", "ence", "ency", "ent", "er", "ern",
  "ese", "esque", "ess", "est", "et", "etic", "ette", "ful", "fully", "fy",
  "hood", "ial", "ian", "ible", "ibly", "ic", "ical", "ically", "ies", "ify",
  "ile", "ily", "ine", "ing", "ion", "ious", "ish", "ism", "ist", "ite",
  "ity", "ive", "ively", "ivity", "ize", "less", "let", "like", "ling", "ly",
  "ment", "most", "ness", "oid", "ology", "or", "ory", "ous", "path", "phile",
  "phone", "proof", "scope", "ship", "sion", "some", "th", "tion", "tional", "ture",
  "ty", "ual", "ular", "ule", "ure", "ward", "wards", "ways", "wise", "y",

  // Common prefixes
  "a", "ab", "ad", "af", "ag", "an", "ap", "ar", "as", "at",
  "be", "bi", "co", "com", "con", "contra", "counter", "de", "di", "dis",
  "en", "em", "epi", "eu", "ex", "extra", "fore", "hemi", "hyper", "il",
  "im", "in", "infra", "inter", "intra", "ir", "macro", "mal", "maxi", "meta",
  "micro", "mid", "mini", "mis", "mono", "multi", "neo", "non", "omni", "out",
  "over", "pan", "para", "peri", "photo", "poly", "post", "pre", "pro", "proto",
  "pseudo", "re", "retro", "self", "semi", "sub", "super", "supra", "sur", "tele",
  "trans", "tri", "ultra", "un", "under", "uni", "up", "vice", "with",

  // Common phrases
  "a lot", "a number of", "according to", "after all", "ahead of", "all but", "all of a sudden",
  "all over", "all right", "along with", "and so on", "as well", "as well as", "as soon as",
  "as if", "as long as", "as much as", "as far as", "at all", "at least", "at once",
  "at most", "at the same time", "back and forth", "back to back", "be able to", "because of",
  "better off", "by the way", "call for", "call off", "call on", "carry on", "carry out",
  "catch up", "check in", "check out", "come across", "come up with", "cut down", "cut off",
  "deal with", "do over", "each other", "end up", "even though", "ever since", "fall apart",
  "far from", "figure out", "fill in", "find out", "for example", "for good", "for sure",
  "get along", "get away", "get back", "get by", "get in", "get off", "get on", "get out",
  "get over", "get rid of", "get together", "get up", "give up", "go ahead", "go back",
  "go on", "go out", "go over", "go through", "grow up", "had better", "hand in",
  "hang on", "have to", "hold on", "in addition", "in advance", "in case", "in charge of",
  "in fact", "in favor of", "in front of", "in general", "in order to", "in other words",
  "in place of", "in spite of", "in time", "instead of", "just about", "keep on",
  "kind of", "look after", "look for", "look forward to", "look out", "look up",
  "make sure", "make up", "more or less", "no matter", "of course", "on account of",
  "on average", "on board", "on purpose", "on the other hand", "once again", "once in a while",
  "one another", "out of", "over and over", "pick up", "point out", "put off", "put on",
  "put up with", "rather than", "right away", "run into", "run out of", "set up",
  "show up", "so far", "sooner or later", "sort of", "stand for", "take after",
  "take care of", "take off", "take on", "take over", "take place", "take up",
  "thank you", "that is", "the same as", "think over", "throw away", "to and fro",
  "try out", "turn down", "turn into", "turn off", "turn on", "turn out", "turn over",
  "up to", "use up", "wait on", "what about", "whether or not", "with regard to",
  "work out", "would rather",

  // Common contractions
  "I'm", "you're", "he's", "she's", "it's", "we're", "they're", "I've", "you've",
  "we've", "they've", "I'll", "you'll", "he'll", "she'll", "it'll", "we'll", "they'll",
  "I'd", "you'd", "he'd", "she'd", "it'd", "we'd", "they'd", "isn't", "aren't",
  "wasn't", "weren't", "haven't", "hasn't", "hadn't", "won't", "wouldn't", "don't",
  "doesn't", "didn't", "can't", "couldn't", "shouldn't", "mightn't", "mustn't",

  // Common technical terms
  "computer", "software", "hardware", "network", "system", "data", "information",
  "application", "program", "code", "algorithm", "function", "variable", "object",
  "class", "method", "interface", "database", "server", "client", "web", "internet",
  "website", "page", "file", "document", "image", "video", "audio", "text", "number",
  "password", "security", "encryption", "database", "query", "search", "result",
  "error", "message", "email", "phone", "mobile", "device", "screen", "display",
  "keyboard", "mouse", "memory", "storage", "processor", "speed", "time", "date",

  // Common numbers and symbols
  "0", "1", "2", "3", "4", "5", "6", "7", "8", "9",
  "10", "100", "1000", "first", "second", "third", "fourth", "fifth", "sixth",
  "seventh", "eighth", "ninth", "tenth", "half", "quarter", "double", "triple",
  "single", "multiple", "few", "many", "several", "most", "all", "none",

  // Time-related
  "time", "day", "week", "month", "year", "hour", "minute", "second", "morning",
  "afternoon", "evening", "night", "today", "tomorrow", "yesterday", "now", "later",
  "soon", "early", "late", "past", "present", "future", "clock", "calendar",
  "schedule", "duration", "period", "moment", "while", "age", "era", "century",

  // Common adjectives
  "good", "bad", "big", "small", "large", "little", "great", "important", "different",
  "same", "new", "old", "young", "high", "low", "long", "short", "early", "late",
  "right", "wrong", "true", "false", "real", "false", "positive", "negative",
  "happy", "sad", "beautiful", "ugly", "rich", "poor", "hot", "cold", "warm", "cool",
  "dark", "light", "heavy", "light", "hard", "soft", "easy", "difficult",
  "simple", "complex", "clean", "dirty", "full", "empty", "open", "closed",

  // Common verbs
  "be", "have", "do", "say", "get", "make", "go", "know", "take", "see",
  "come", "think", "look", "want", "give", "use", "find", "tell", "ask", "work",
  "seem", "feel", "try", "leave", "call", "put", "set", "run", "move", "live",
  "believe", "bring", "happen", "write", "provide", "sit", "stand", "lose", "pay",
  "meet", "include", "continue", "change", "begin", "start", "stop", "create",
  "develop", "understand", "learn", "play", "run", "walk", "talk", "speak", "read",

  // add
"about the", "above all", "according to", "across from", "after that", "after the", "against the",
"all about", "all at once", "all over the", "along the", "among the", "around the", "as a result",
"as a whole", "as far as", "as for", "as if", "as long as", "as well as", "at a time", "at first",
"at least", "at once", "at the same time", "back to", "based on", "because of", "before the",
"behind the", "between the", "by far", "by means of", "by the way", "close to", "due to",
"even if", "even though", "except for", "far from", "for a while", "for example", "for the most part",
"for the sake of", "from a", "from the", "in a way", "in addition", "in case of", "in front of",
"in general", "in order to", "in place of", "in spite of", "in terms of", "in the end",
"in the middle", "in the process", "in the sense", "in the world", "in time", "in view of",
"inside of", "instead of", "on a", "on account of", "on behalf of", "on top of", "on the other hand",
"once again", "one by one", "out of the", "over the", "part of", "regardless of", "right away",
"such as", "thanks to", "up to", "with a", "with respect to", "with the help of", "without a",
"without the", "according", "actually", "additionally", "afterward", "alongside", "altogether",
"apparently", "approximately", "around", "as well", "attractive", "basically", "carefully",
"certainly", "clearly", "completely", "constantly", "currently", "definitely", "directly",
"efficiently", "eventually", "exactly", "especially", "essentially", "extremely", "finally",
"frequently", "generally", "gradually", "honestly", "however", "immediately", "in fact",
"instead", "literally", "mainly", "naturally", "obviously", "particularly", "possibly",
"previously", "primarily", "probably", "quickly", "recently", "relatively", "similarly",
"simply", "specifically", "suddenly", "therefore", "totally", "usually", "virtually",
"within", "without", "according to the", "as a matter of fact", "as soon as possible",
"at the same time as", "by and large", "for all intents and purposes", "for the most part",
"in accordance with", "in case of emergency", "in charge of the", "in connection with",
"in favor of the", "in keeping with", "in line with", "in place of the", "in relation to",
"in regard to", "in response to", "in terms of the", "in the event of", "on behalf of the",
"on the basis of", "on the part of", "with a view to", "with regard to the", "with respect to the",

// More tech / modern terms
"AI", "artificial intelligence", "machine learning", "deep learning", "neural network", 
"data science", "big data", "cloud computing", "blockchain", "IoT", "internet of things",
"frontend", "backend", "full stack", "API", "SDK", "GUI", "UX", "UI", "responsive design",
"framework", "library", "repository", "version control", "GitHub", "GitLab", "pull request",
"commit", "merge", "branch", "docker", "kubernetes", "virtual machine", "container",
"serverless", "database schema", "query language", "SQL", "NoSQL", "JSON", "REST API", 
"GraphQL", "endpoint", "HTTP request", "HTTPS", "encryption key", "hashing", "tokenization",
"password reset", "two-factor authentication", "biometrics", "fingerprint", "facial recognition",

// More number / measurement expressions
"a few", "a little", "a lot of", "all of them", "any of them", "both of them", "each of them",
"half of them", "one of them", "some of them", "most of them", "none of them", "dozen of",
"pair of", "couple of", "thousands of", "millions of", "billions of", "hundreds of",
"first of all", "second of all", "third of all",

// More common verbs + phrases
"ask for", "break down", "bring about", "bring up", "call back", "carry on", "check out",
"come along", "come by", "come down", "come in", "come off", "come out", "come through",
"cut back", "cut in", "cut out", "do away with", "drop by", "drop off", "figure out", "fill out",
"find out", "follow up", "get across", "get ahead", "get along with", "get around", "get at",
"get away with", "get back at", "get behind", "get in touch", "get on with", "get over with",
"get rid", "get together with", "give in", "give out", "give up on", "go along with",
"go ahead with", "go back on", "go in for", "go out with", "go through with", "hand in",
"hold back", "hold on to", "keep on with", "look after", "look around", "look back on",
"look down on", "look forward to", "look into", "look out for", "look over", "look up to",
"make out", "make up for", "pick out", "pick up on", "put across", "put away", "put down",
"put off", "put on", "put out", "put up with", "run across", "run into", "run out of",
"set aside", "set out", "set up with", "take after", "take apart", "take back", "take down",
"take in", "take off on", "take on with", "take out", "take over from", "take up with",
"turn around", "turn away", "turn down", "turn in", "turn off", "turn on", "turn out to be",
"turn over", "wait for", "watch out for", "work out", "write down", "write up",

// 2-letter combos
"aa", "ab", "ac", "ad", "ae", "af", "ag", "ah", "ai", "aj", "ak", "al", "am", "an", "ao", "ap", "aq", "ar", "as", "at", "au", "av", "aw", "ax", "ay", "az",
"ba", "bb", "bc", "bd", "be", "bf", "bg", "bh", "bi", "bj", "bk", "bl", "bm", "bn", "bo", "bp", "bq", "br", "bs", "bt", "bu", "bv", "bw", "bx", "by", "bz",
"ca", "cb", "cc", "cd", "ce", "cf", "cg", "ch", "ci", "cj", "ck", "cl", "cm", "cn", "co", "cp", "cq", "cr", "cs", "ct", "cu", "cv", "cw", "cx", "cy", "cz",
"da", "db", "dc", "dd", "de", "df", "dg", "dh", "di", "dj", "dk", "dl", "dm", "dn", "do", "dp", "dq", "dr", "ds", "dt", "du", "dv", "dw", "dx", "dy", "dz",
"ea", "eb", "ec", "ed", "ee", "ef", "eg", "eh", "ei", "ej", "ek", "el", "em", "en", "eo", "ep", "eq", "er", "es", "et", "eu", "ev", "ew", "ex", "ey", "ez",
"fa", "fb", "fc", "fd", "fe", "ff", "fg", "fh", "fi", "fj", "fk", "fl", "fm", "fn", "fo", "fp", "fq", "fr", "fs", "ft", "fu", "fv", "fw", "fx", "fy", "fz",
"ga", "gb", "gc", "gd", "ge", "gf", "gg", "gh", "gi", "gj", "gk", "gl", "gm", "gn", "go", "gp", "gq", "gr", "gs", "gt", "gu", "gv", "gw", "gx", "gy", "gz",
"ha", "hb", "hc", "hd", "he", "hf", "hg", "hh", "hi", "hj", "hk", "hl", "hm", "hn", "ho", "hp", "hq", "hr", "hs", "ht", "hu", "hv", "hw", "hx", "hy", "hz",
"ia", "ib", "ic", "id", "ie", "if", "ig", "ih", "ii", "ij", "ik", "il", "im", "in", "io", "ip", "iq", "ir", "is", "it", "iu", "iv", "iw", "ix", "iy", "iz",
"ja", "jb", "jc", "jd", "je", "jf", "jg", "jh", "ji", "jj", "jk", "jl", "jm", "jn", "jo", "jp", "jq", "jr", "js", "jt", "ju", "jv", "jw", "jx", "jy", "jz",
"ka", "kb", "kc", "kd", "ke", "kf", "kg", "kh", "ki", "kj", "kk", "kl", "km", "kn", "ko", "kp", "kq", "kr", "ks", "kt", "ku", "kv", "kw", "kx", "ky", "kz",
"la", "lb", "lc", "ld", "le", "lf", "lg", "lh", "li", "lj", "lk", "ll", "lm", "ln", "lo", "lp", "lq", "lr", "ls", "lt", "lu", "lv", "lw", "lx", "ly", "lz",
"ma", "mb", "mc", "md", "me", "mf", "mg", "mh", "mi", "mj", "mk", "ml", "mm", "mn", "mo", "mp", "mq", "mr", "ms", "mt", "mu", "mv", "mw", "mx", "my", "mz",
"na", "nb", "nc", "nd", "ne", "nf", "ng", "nh", "ni", "nj", "nk", "nl", "nm", "nn", "no", "np", "nq", "nr", "ns", "nt", "nu", "nv", "nw", "nx", "ny", "nz",
"oa", "ob", "oc", "od", "oe", "of", "og", "oh", "oi", "oj", "ok", "ol", "om", "on", "oo", "op", "oq", "or", "os", "ot", "ou", "ov", "ow", "ox", "oy", "oz",
"pa", "pb", "pc", "pd", "pe", "pf", "pg", "ph", "pi", "pj", "pk", "pl", "pm", "pn", "po", "pp", "pq", "pr", "ps", "pt", "pu", "pv", "pw", "px", "py", "pz",
"qa", "qb", "qc", "qd", "qe", "qf", "qg", "qh", "qi", "qj", "qk", "ql", "qm", "qn", "qo", "qp", "qq", "qr", "qs", "qt", "qu", "qv", "qw", "qx", "qy", "qz",
"ra", "rb", "rc", "rd", "re", "rf", "rg", "rh", "ri", "rj", "rk", "rl", "rm", "rn", "ro", "rp", "rq", "rr", "rs", "rt", "ru", "rv", "rw", "rx", "ry", "rz",
"sa", "sb", "sc", "sd", "se", "sf", "sg", "sh", "si", "sj", "sk", "sl", "sm", "sn", "so", "sp", "sq", "sr", "ss", "st", "su", "sv", "sw", "sx", "sy", "sz",
"ta", "tb", "tc", "td", "te", "tf", "tg", "th", "ti", "tj", "tk", "tl", "tm", "tn", "to", "tp", "tq", "tr", "ts", "tt", "tu", "tv", "tw", "tx", "ty", "tz",
"ua", "ub", "uc", "ud", "ue", "uf", "ug", "uh", "ui", "uj", "uk", "ul", "um", "un", "uo", "up", "uq", "ur", "us", "ut", "uu", "uv", "uw", "ux", "uy", "uz",
"va", "vb", "vc", "vd", "ve", "vf", "vg", "vh", "vi", "vj", "vk", "vl", "vm", "vn", "vo", "vp", "vq", "vr", "vs", "vt", "vu", "vv", "vw", "vx", "vy", "vz",
"wa", "wb", "wc", "wd", "we", "wf", "wg", "wh", "wi", "wj", "wk", "wl", "wm", "wn", "wo", "wp", "wq", "wr", "ws", "wt", "wu", "wv", "ww", "wx", "wy", "wz",
"xa", "xb", "xc", "xd", "xe", "xf", "xg", "xh", "xi", "xj", "xk", "xl", "xm", "xn", "xo", "xp", "xq", "xr", "xs", "xt", "xu", "xv", "xw", "xx", "xy", "xz",
"ya", "yb", "yc", "yd", "ye", "yf", "yg", "yh", "yi", "yj", "yk", "yl", "ym", "yn", "yo", "yp", "yq", "yr", "ys", "yt", "yu", "yv", "yw", "yx", "yy", "yz",
"za", "zb", "zc", "zd", "ze", "zf", "zg", "zh", "zi", "zj", "zk", "zl", "zm", "zn", "zo", "zp", "zq", "zr", "zs", "zt", "zu", "zv", "zw", "zx", "zy", "zz",

// common number combos
"00", "01", "02", "03", "04", "05", "06", "07", "08", "09",
"10", "11", "12", "13", "14", "15", "16", "17", "18", "19",
"20", "21", "22", "23", "24", "25", "26", "27", "28", "29",
"30", "31", "32", "33", "34", "35", "36", "37", "38", "39",
"40", "41", "42", "43", "44", "45", "46", "47", "48", "49",
"50", "51", "52", "53", "54", "55", "56", "57", "58", "59",
"60", "61", "62", "63", "64", "65", "66", "67", "68", "69",
"70", "71", "72", "73", "74", "75", "76", "77", "78", "79",
"80", "81", "82", "83", "84", "85", "86", "87", "88", "89",
"90", "91", "92", "93", "94", "95", "96", "97", "98", "99",

// common letter-symbol combos
"a!", "b!", "c!", "d!", "e!", "f!", "g!", "h!", "i!", "j!", "k!", "l!", "m!", "n!", "o!", "p!", "q!", "r!", "s!", "t!", "u!", "v!", "w!", "x!", "y!", "z!",
"a?", "b?", "c?", "d?", "e?", "f?", "g?", "h?", "i?", "j?", "k?", "l?", "m?", "n?", "o?", "p?", "q?", "r?", "s?", "t?", "u?", "v?", "w?", "x?", "y?", "z?",
"a.", "b.", "c.", "d.", "e.", "f.", "g.", "h.", "i.", "j.", "k.", "l.", "m.", "n.", "o.", "p.", "q.", "r.", "s.", "t.", "u.", "v.", "w.", "x.", "y.", "z.",

// 3-letter combos

// Common English trigrams
"the", "and", "ing", "ion", "tio", "for", "tha", "ent", "ati", "her", "ter",
"ere", "ate", "his", "con", "res", "ver", "all", "ons", "nce", "men", "ith",
"ted", "ers", "pro", "thi", "wit", "are", "ess", "not", "ive", "was", "ect",
"rea", "com", "eve", "per", "int", "est", "sta", "cti", "ica", "ist", "ear",
"ain", "one", "our", "iti", "rat", "res",

// Common functional trigrams
"and", "for", "the", "you", "but", "are", "all", "not", "any", "can", "had",
"has", "her", "his", "out", "she", "who", "how", "was", "one", "our", "too",
"see", "may", "get", "now", "day", "new", "try", "let", "put", "run", "set",

// Common contractions
"n't", "'re", "'ve", "'ll", "'d", "'s", "'m", "'t",

// Common prefixes
"pre", "pro", "sub", "dis", "un", "re", "con", "com", "non", "mis", "out", "over", "under",

// Common suffixes
"ing", "ion", "est", "ant", "ent", "ful", "less", "ous", "ive", "ity", "ment",

// Letter-letter-letter combos (full a-z)
"aaa", "aab", "aac", "aad", "aae", "aaf", "aag", "aah", "aai", "aaj", "aak", "aal", "aam", "aan", "aao", "aap", "aaq", "aar", "aas", "aat", "aau", "aav", "aaw", "aax", "aay", "aaz",
"aba", "abb", "abc", "abd", "abe", "abf", "abg", "abh", "abi", "abj", "abk", "abl", "abm", "abn", "abo", "abp", "abq", "abr", "abs", "abt", "abu", "abv", "abw", "abx", "aby", "abz",
"aca", "acb", "acc", "acd", "ace", "acf", "acg", "ach", "aci", "acj", "ack", "acl", "acm", "acn", "aco", "acp", "acq", "acr", "acs", "act", "acu", "acv", "acw", "acx", "acy", "acz",
"ada", "adb", "adc", "add", "ade", "adf", "adg", "adh", "adi", "adj", "adk", "adl", "adm", "adn", "ado", "adp", "adq", "adr", "ads", "adt", "adu", "adv", "adw", "adx", "ady", "adz",
// ... same pattern for b**, c**, d** ... up to z**

// Number-inclusive trigrams
"a1a", "b2b", "c3c", "d4d", "e5e", "f6f", "g7g", "h8h", "i9i", "j0j",
"1a1", "2b2", "3c3", "4d4", "5e5", "6f6", "7g7", "8h8", "9i9", "0j0",

// Letter-symbol-letter combos
"a!a", "b@b", "c#c", "d$d", "e%e", "f^f", "g&g", "h*h", "i(i", "j)j",
"k-k", "l_l", "m+m", "n=n", "o{o", "p}p", "q[q", "r]r", "s|s", "t\\t",
"u/u", "v:v", "w;w", "x,x", "y.y", "z?z",

// Common word-start trigrams
"the", "tha", "thi", "for", "fro", "and", "are", "con", "com", "int", "pro", "pre", "sub", "dis", "ver", "was", "not", "one", "all",

// Common word-end trigrams
"ing", "ion", "ent", "ant", "ter", "her", "ers", "est", "ity", "ful", "ous", "ive", "ess",
// More 3-letter combos

// Common trigrams from English words
"the", "and", "ing", "ion", "tio", "for", "tha", "ent", "ati", "her", "ter",
"ere", "ate", "his", "con", "res", "ver", "all", "ons", "nce", "men", "ith",
"ted", "ers", "pro", "thi", "wit", "are", "ess", "not", "ive", "was", "ect",
"rea", "com", "eve", "per", "int", "est", "sta", "cti", "ica", "ist", "ear",
"ain", "one", "our", "iti", "rat", "res", "ous", "ful", "ive", "ant", "ent",

// Common prefixes + roots
"pre", "pro", "sub", "dis", "unr", "re-", "con", "com", "non", "mis", "out", "over",
"under", "sup", "anti", "auto", "tri", "uni", "neo", "post", "mid", "inter", "intra",

// Common suffixes
"ing", "ion", "ent", "ant", "ter", "est", "ity", "ous", "ful", "ess", "ive", "acy",
"ize", "ise", "ate", "ify", "ble", "ial", "ish", "ism", "ist", "ity", "ure",

// Common consonant clusters
"str", "spr", "scr", "shr", "thr", "spl", "chr", "spl", "squ", "shr", "phs", "ght",
"nch", "tch", "sch", "ckl", "mpl", "mpl", "ndl", "ngs", "nts",

// Common vowel clusters
"air", "ear", "eir", "ier", "our", "our", "out", "ous", "eau", "iou", "eio", "ieu",
"igh", "igh", "aer", "aia", "eia", "eio", "iou", "oui", "oie",

// Functional / grammatical trigrams
"the", "and", "for", "but", "are", "not", "you", "all", "any", "can", "had",
"has", "her", "his", "was", "one", "our", "too", "see", "may", "get", "now",
"let", "put", "run", "set", "try", "ask", "use", "pay", "buy", "cut", "hit",
"won", "use", "end", "add", "fix", "run", "win",

// Pronoun/auxiliary trigrams
"you", "the", "our", "all", "any", "was", "has", "had", "its", "her", "his", "not",
"are", "can", "did", "for", "but", "get", "see", "may", "let", "put", "run", "try",

// Common word endings for verbs/nouns/adjectives
"ing", "ion", "ent", "ant", "ter", "ous", "ful", "ive", "est", "acy", "ate", "ify",
"ize", "ish", "ism", "ist", "ity", "ure", "ely", "ally", "ely", "ous",

// Technical/modern trigrams
"app", "api", "gui", "uxi", "uix", "cli", "srv", "srv", "dbs", "sql", "nos", "nos",
"json", "xml", "htt", "https", "tcp", "udp", "ip-", "url", "cmd", "dev", "ops",
"sys", "srv", "mem", "cpu", "gpu", "ram", "ssd", "hdd", "vm-", "vms", "net",

// Number-letter combos
"a1a", "b2b", "c3c", "d4d", "e5e", "f6f", "g7g", "h8h", "i9i", "j0j",
"1a1", "2b2", "3c3", "4d4", "5e5", "6f6", "7g7", "8h8", "9i9", "0j0",

// Letter-symbol combos
"a!a", "b@b", "c#c", "d$d", "e%e", "f^f", "g&g", "h*h", "i(i", "j)j",
"k-k", "l_l", "m+m", "n=n", "o{o", "p}p", "q[q", "r]r", "s|s", "t\\t",
"u/u", "v:v", "w;w", "x,x", "y.y", "z?z",

// Random useful trigrams
"nth", "tch", "ght", "sch", "str", "spl", "shr", "scr", "spr", "thr",
"ing", "ion", "est", "ent", "ant", "ous", "ful", "ive", "all", "our", "any",
"the", "and", "for", "are", "but", "not", "you", "all", "any", "can", "had",
"has", "her", "his", "was", "one", "our", "too", "see", "may", "get", "now",
"let", "put", "run", "set", "try", "ask", "use", "pay", "buy", "cut", "hit",
"won", "end", "add", "fix", "act", "aid", "aim", "air", "arm", "art", "ask",
"bar", "bat", "bed", "bee", "bet", "box", "boy", "bun", "bus", "cab", "cat",
"cap", "car", "cow", "cry", "cut", "dig", "dog", "dry", "ear", "eat", "egg",
"far", "fat", "fit", "fun", "fur", "gas", "gun", "gym", "hat", "hen", "hot",
"ink", "jam", "jar", "jet", "key", "kid", "leg", "let", "man", "map", "mat",
"may", "men", "mix", "net", "new", "not", "now", "oak", "odd", "off", "oil",
"old", "one", "our", "out", "own", "pad", "pan", "pat", "pen", "pet", "pie",
"pig", "pop", "pot", "put", "ran", "rat", "red", "run", "sad", "sat", "say",
"see", "she", "sit", "sky", "son", "sun", "tap", "tax", "tea", "ten", "the",
"tie", "tip", "top", "toy", "try", "use", "van", "war", "was", "way", "wet",
"win", "won", "yes", "yet", "you", "zip", "zoo",
"able", "acid", "also", "area", "army", "away", "baby", "back", "ball",
"band", "bank", "base", "bath", "bear", "beat", "been", "beer", "bell",
"belt", "best", "bill", "bird", "blow", "blue", "boat", "body", "bomb",
"bond", "bone", "book", "boom", "born", "boss", "both", "bowl", "buck",
"burn", "bush", "busy", "call", "calm", "came", "camp", "card", "care",
"case", "cash", "cast", "cell", "chat", "chip", "city", "club", "coal",
"coat", "code", "cold", "come", "cook", "cool", "copy", "cord", "core",
"cost", "crew", "crop", "dark", "data", "date", "dawn", "days", "dead",
"deal", "dear", "deck", "deep", "desk", "dial", "diet", "disk", "does",
"done", "door", "dose", "down", "draw", "drop", "drug", "dual", "duck",
"dust", "duty", "each", "earn", "ease", "east", "easy", "edge", "else",
"even", "ever", "evil", "exit", "face", "fact", "fail", "fair", "fall",
"farm", "fast", "fate", "fear", "feed", "feel", "feet", "fell", "felt",
"file", "fill", "film", "find", "fine", "fire", "firm", "fish", "five",
"flat", "flow", "food", "foot", "ford", "form", "fort", "four", "free",
"from", "fuel", "full", "fund", "gain", "game", "gate", "gave", "gear",
"gene", "gift", "girl", "give", "glad", "goal", "goes", "gold", "gone",
"good", "gray", "grew", "grey", "grow", "gulf", "hair", "half", "hall",
"hand", "hang", "hard", "harm", "hate", "have", "head", "hear", "heat",
"held", "hell", "help", "here", "hero", "high", "hill", "hire", "hold",
"hole", "holy", "home", "hope", "host", "hour", "huge", "hung", "hunt",
"hurt", "idea", "inch", "into", "iron", "item", "jack", "jazz", "join",
"jump", "jury", "just", "keen", "keep", "kent", "kick", "kill", "kind",
"king", "knee", "know", "lack", "lady", "laid", "lake", "land", "lane",
"last", "late", "lead", "left", "less", "life", "lift", "like", "line",
"link", "list", "live", "load", "loan", "lock", "logo", "long", "look",
"lord", "lose", "loss", "lost", "love", "luck", "made", "mail", "main",
"make", "male", "many", "mark", "mass", "mate", "meal", "mean", "meat",
"meet", "menu", "mere", "mice", "mind", "mine", "miss", "mode", "mood",
"moon", "more", "most", "move", "much", "must", "name", "navy", "near",
"neck", "need", "news", "next", "nice", "nick", "nine", "none", "nose",
"note", "okay", "once", "only", "open", "over", "pace", "pack", "page",
"paid", "pain", "pair", "palm", "park", "part", "pass", "past", "path",
"peak", "pick", "pile", "pink", "pipe", "plan", "play", "plot", "plug",
"plus", "poll", "pool", "poor", "port", "pose", "post", "pull", "pure",
"push", "race", "rail", "rain", "rank", "rare", "rate", "read", "real",
"rear", "rely", "rent", "rest", "rice", "rich", "ride", "ring", "rise",
"risk", "road", "rock", "role", "roof", "room", "root", "rose", "rule",
"rush", "safe", "said", "sake", "sale", "salt", "same", "sand", "save",
"seat", "seed", "seek", "seen", "self", "sell", "send", "sent", "seat",
"ship", "shop", "show", "shut", "side", "sign", "site", "size", "skin",
"slip", "slow", "snow", "soil", "some", "song", "sort", "star", "stay",
"step", "stop", "such", "suit", "sure", "take", "tale", "talk", "tall",
"team", "tell", "tend", "term", "test", "text", "than", "that", "them",
"then", "they", "thin", "this", "thus", "time", "told", "tone", "tony",
"tool", "tour", "town", "tree", "trip", "true", "turn", "type", "unit",
"upon", "used", "user", "vary", "vast", "very", "view", "vote", "wait",
"walk", "wall", "want", "ward", "warm", "wash", "wave", "ways", "weak",
"wear", "week", "well", "went", "were", "west", "what", "when", "whom",
"wide", "wife", "wild", "will", "wind", "wine", "wing", "wise", "wish",
"with", "word", "work", "yard", "year", "your", "zero", "zone"






];


let dictionaryPatterns = [];
function addToDict(str) {
  if (!dictionaryPatterns.includes(str)) dictionaryPatterns.push(str);
}
baseWords.forEach(word => addToDict(word));
dictionaryPatterns.sort((a, b) => b.length - a.length);

// Enhanced Symbol Pool with more characters
function generateSymbols() {
  let syms = [];
  
  // Tibetan characters (compact)
  for(let i=0x0F00; i<=0x0FFF; i++) syms.push(String.fromCharCode(i));
  
  // Mathematical Operators
  for(let i=0x2200; i<=0x22FF; i++) syms.push(String.fromCharCode(i));
  
  // Geometric Shapes
  for(let i=0x25A0; i<=0x25FF; i++) syms.push(String.fromCharCode(i));
  
  // Box Drawing
  for(let i=0x2500; i<=0x257F; i++) syms.push(String.fromCharCode(i));
  
  // Miscellaneous Symbols
  for(let i=0x2600; i<=0x26FF; i++) syms.push(String.fromCharCode(i));
  
  // Dingbats
  for(let i=0x2700; i<=0x27BF; i++) syms.push(String.fromCharCode(i));
  
  // Supplemental Arrows
  for(let i=0x2900; i<=0x297F; i++) syms.push(String.fromCharCode(i));
  
  // Braille Patterns 
  for(let i=0x2800; i<=0x28FF; i++) syms.push(String.fromCharCode(i));
  
  // Additional symbols
  for(let i=0x4E00; i<=0x4FE0; i+=2) syms.push(String.fromCharCode(i));
  
  // Cyrillic Extended
  for(let i=0x2DE0; i<=0x2DFF; i++) syms.push(String.fromCharCode(i));
  
  // Ensure enough symbols for compression
  syms.push(..."∀∁∂∃∄∅∆∇∈∉∊∋∌∍∎∏∐∑−∓∔∕∖∗∘∙√∛∜∝∞∟∠∡∢∣∤∥∦∧∨∩∪∫∬∭∮∯∰∱∲∳∴∵∶∷∸∹∺∻∼∽∾∿≀≁≂≃≄≅≆≇≈≉≊≋≌≍≎≏≐≑≒≓≔≕≖≗≘≙≚≛≜≝≞≟≠≡≢≣≤≥≦≧≨≩≪≫≬≭≮≯≰≱≲≳≴≵≶≷≸≹≺≻≼≽≾≿⊀⊁⊂⊃⊄⊅⊆⊇⊈⊉⊊⊋⊌⊍⊎⊏⊐⊑⊒⊓⊔⊕⊖⊗⊘⊙⊚⊛⊜⊝⊞⊟⊠⊡⊢⊣⊤⊥⊦⊧⊨⊩⊪⊫⊬⊭⊮⊯⊰⊱⊲⊳⊴⊵⊶⊷⊸⊹⊺⊻⊼⊽⊾⊿⋀⋁⋂⋃⋄⋅⋆⋇⋈⋉⋊⋋⋌⋍⋎⋏⋐⋑⋒⋓⋔⋕⋖⋗⋘⋙⋚⋛⋜⋝⋞⋟⋠⋡⋢⋣⋤⋥⋦⋧⋨⋩⋪⋫⋬⋭⋮⋯⋰⋱");
  
  // Greek and Coptic
  for(let i=0x0370; i<=0x03FF; i++) syms.push(String.fromCharCode(i));
  
  // Enclosed Alphanumerics
  for(let i=0x2460; i<=0x24FF; i++) syms.push(String.fromCharCode(i));
  
  return syms;
}

const allSymbols = generateSymbols();
let dictToSymbol = {};
let symbolToDict = {};
let singleCharMap = {};
let singleCharReverseMap = {};

function buildDictionaryMappings() {
  dictToSymbol = {};
  symbolToDict = {};
  
  // Assign symbols to dictionary patterns
  for (let i = 0; i < dictionaryPatterns.length && i < allSymbols.length; i++) {
    const pattern = dictionaryPatterns[i];
    const sym = allSymbols[i];
    dictToSymbol[pattern] = sym;
    symbolToDict[sym] = pattern;
  }
  
  // Assign symbols to individual characters for better compression
  singleCharMap = {};
  singleCharReverseMap = {};
  
  for (let i = 0; i < normalAlphabet.length; i++) {
    const symbolIndex = i + dictionaryPatterns.length;
    if (symbolIndex < allSymbols.length) {
      const char = normalAlphabet[i];
      const sym = allSymbols[symbolIndex];
      singleCharMap[char] = sym;
      singleCharReverseMap[sym] = char;
    }
  }
}

buildDictionaryMappings();

function makeRngFromKey(key) {
  let hash = 2166136261;
  for (const ch of key) {
    hash ^= ch.charCodeAt(0);
    hash = Math.imul(hash, 16777619);
  }
  return function() {
    hash ^= hash << 13; hash ^= hash >> 17; hash ^= hash << 5;
    return (hash >>> 0) / 4294967296;
  }
}

function shuffleMapping(key) {
  const rng = makeRngFromKey(key || "default-static-seed");
  
  // Create arrays from the mappings for shuffling
  const dictPatterns = Object.keys(dictToSymbol);
  const dictSymbols = dictPatterns.map(pattern => dictToSymbol[pattern]);
  
  const singleChars = Object.keys(singleCharMap);
  const singleSymbols = singleChars.map(char => singleCharMap[char]);
  
  // Fisher-Yates shuffle for dictionary mappings
  for (let i = dictPatterns.length - 1; i > 0; i--) {
    const j = Math.floor(rng() * (i + 1));
    [dictPatterns[i], dictPatterns[j]] = [dictPatterns[j], dictPatterns[i]];
    [dictSymbols[i], dictSymbols[j]] = [dictSymbols[j], dictSymbols[i]];
  }
  
  // Fisher-Yates shuffle for single character mappings
  for (let i = singleChars.length - 1; i > 0; i--) {
    const j = Math.floor(rng() * (i + 1));
    [singleChars[i], singleChars[j]] = [singleChars[j], singleChars[i]];
    [singleSymbols[i], singleSymbols[j]] = [singleSymbols[j], singleSymbols[i]];
  }
  
  // Rebuild mappings
  dictToSymbol = {};
  symbolToDict = {};
  for (let i = 0; i < dictPatterns.length; i++) {
    dictToSymbol[dictPatterns[i]] = dictSymbols[i];
    symbolToDict[dictSymbols[i]] = dictPatterns[i];
  }
  
  singleCharMap = {};
  singleCharReverseMap = {};
  for (let i = 0; i < singleChars.length; i++) {
    singleCharMap[singleChars[i]] = singleSymbols[i];
    singleCharReverseMap[singleSymbols[i]] = singleChars[i];
  }
}

function encrypt(text, key) {
  // Shuffle mappings based on key
  shuffleMapping(key);
  
  let output = [];
  let currentIndex = 0;
  
  while (currentIndex < text.length) {
    let matchedPattern = null;
    
    // Look for the longest matching pattern from the dictionary
    for (let pattern of dictionaryPatterns) {
      if (currentIndex + pattern.length <= text.length && 
          text.substring(currentIndex, currentIndex + pattern.length) === pattern) {
        matchedPattern = pattern;
        break;
      }
    }
    
    if (matchedPattern) {
      // Use dictionary mapping
      output.push(dictToSymbol[matchedPattern]);
      currentIndex += matchedPattern.length;
    } else {
      // Encode single character
      const currentChar = text[currentIndex];
      
      if (currentChar in singleCharMap) {
        // Use single character mapping
        output.push(singleCharMap[currentChar]);
      } else {
        // Character not in normalAlphabet, output as-is
        output.push(currentChar);
      }
      
      currentIndex++;
    }
  }
  
  return output.join('');
}

function decrypt(text, key) {
  // Shuffle mappings based on key (must be same as encryption)
  shuffleMapping(key);
  
  let output = [];
  let symbols = Array.from(text);
  
  for (let i = 0; i < symbols.length; i++) {
    const symbol = symbols[i];
    
    // First check if it's a dictionary pattern
    if (symbolToDict[symbol]) {
      output.push(symbolToDict[symbol]);
    } 
    // Then check if it's a single character mapping
    else if (singleCharReverseMap[symbol]) {
      output.push(singleCharReverseMap[symbol]);
    }
    // Otherwise output symbol as-is
    else {
      output.push(symbol);
    }
  }
  
  return output.join('');
}

let isUpdating = false;

function updateStats() {
  const origLen = originalBox.value.length;
  const encLen = encryptedBox.value.length;
  
  originalCount.textContent = `${origLen} character${origLen !== 1 ? 's' : ''}`;
  encryptedCount.textContent = `${encLen} character${encLen !== 1 ? 's' : ''}`;
  
  if (origLen > 0) {
    const savings = Math.round((1 - (encLen / origLen)) * 100);
    const reduction = origLen - encLen;
    
    if (reduction < 0 || savings < 0) {
      compressionValue.textContent = `${Math.abs(savings)}%`;
      compressionValue.className = 'stat-value negative';
      reductionValue.textContent = `+${Math.abs(reduction)}`;
      reductionValue.className = 'stat-value negative';
    } else {
      compressionValue.textContent = `${savings}%`;
      compressionValue.className = 'stat-value positive';
      reductionValue.textContent = `−${reduction}`;
      reductionValue.className = 'stat-value positive';
    }
  } else {
    compressionValue.textContent = '0%';
    compressionValue.className = 'stat-value neutral';
    reductionValue.textContent = '0';
    reductionValue.className = 'stat-value neutral';
  }
}

function updateFromOriginal() {
  if (isUpdating) return;
  
  try {
    isUpdating = true;
    const encrypted = encrypt(originalBox.value, keyBox.value);
    encryptedBox.value = encrypted;
    updateStats();
  } catch (error) {
    console.error("Encryption error:", error);
  } finally {
    isUpdating = false;
  }
}

function updateFromEncrypted() {
  if (isUpdating) return;
  
  try {
    isUpdating = true;
    const decrypted = decrypt(encryptedBox.value, keyBox.value);
    originalBox.value = decrypted;
    updateStats();
  } catch (error) {
    console.error("Decryption error:", error);
  } finally {
    isUpdating = false;
  }
}

originalBox.addEventListener("input", updateFromOriginal);
encryptedBox.addEventListener("input", updateFromEncrypted);
keyBox.addEventListener("input", updateFromOriginal);

window.addEventListener('load', () => {
  updateFromOriginal();
});
</script>
</body>
</html>
